# SPR-002 — Scaffolding monorepo (backend+frontend) + tooling base (Local-first)
**Estado:** BLOQUEADO (no editar; cambios solo por RFC/ADR/CHANGELOG)  
**Stage:** 1 (Core local)  
**Duración objetivo:** 45–90 min  
**Tipo:** Infra/Setup (scaffold), sin features de negocio

---

## 1) Objetivo (qué se logra)
Dejar el repositorio **ejecutable en local** con estructura base de monorepo:
- `backend/` Spring Boot (Java 21, Maven wrapper) con healthcheck.
- `frontend/` React + Vite + TS + Tailwind + shadcn/ui con pantalla mínima (ES).
- Tooling mínimo:
  - Backend: formatter/lint (placeholder si no da el tiempo, pero dejando la base preparada sin inventar).
  - Frontend: ESLint + Prettier.
- Scripts de smoke mínimos (PowerShell) para arrancar y verificar “up”.

**Reglas clave a respetar**
- Código en inglés (clases/variables). UI en español.
- Sin Docker.
- No inventar comandos inexistentes: todo lo que se documente debe existir.

---

## 2) Alcance

### 2.1 INCLUYE (Scope = Sí)
**Estructura**
- Crear carpetas: `backend/`, `frontend/`, `scripts/`, `scripts/smoke/` (si no existen).
- Mantener `docs/**` intacto salvo actualizaciones de LOG/STATUS/CHANGELOG relacionadas al sprint.

**Backend scaffold**
- Spring Boot 3.x (Maven) con:
  - `spring-boot-starter-web`
  - `spring-boot-starter-actuator`
  - `spring-boot-starter-validation`
  - tests base (`spring-boot-starter-test`)
- Endpoint de salud: `/actuator/health`.
- Config mínima en `application.yml` para correr local.
- README/Runbook: solo actualizar si ya existe sección de comandos reales (opcional; si no está en scope, NO tocar).

**Frontend scaffold**
- Vite + React + TS.
- Tailwind + shadcn/ui instalado/configurado.
- Pantalla mínima:
  - Login (UI ES) **solo UI**, sin auth real aún.
  - Shell básico (menú) placeholder.

**Scripts smoke**
- `scripts/smoke/sprint2.ps1`:
  - Arranca backend y verifica `/actuator/health`.
  - Arranca frontend y verifica que inicia sin error (log simple).
  - **No requiere Docker**.

### 2.2 EXCLUYE (Scope = No)
- Migraciones DB / Flyway (va en SPR-003).
- Seguridad real / login real / JWT (va en SPR-004).
- CRUD de dominio.
- E-commerce funcional.
- SRI/fiscal.

---

## 3) Pre-check (obligatorio para Codex)
Codex debe ejecutar y reportar:
1) `git status` (si no está limpio: detenerse)
2) `git config user.name` y `git config user.email` (si falta: detenerse)
3) `git rev-parse --abbrev-ref HEAD` (reportar rama)

---

## 4) Entregables

### 4.1 Estructura de repo
- `backend/` con proyecto Spring Boot ejecutable.
- `frontend/` con proyecto Vite ejecutable.
- `scripts/smoke/sprint2.ps1`.

### 4.2 Backend mínimo
- Compila y corre local.
- `/actuator/health` responde `UP`.

### 4.3 Frontend mínimo
- `npm install` y `npm run dev` funciona.
- UI en español (aunque sea placeholder).

---

## 5) Instrucciones de implementación (cerradas)
Codex debe hacer exactamente esto (sin extras):

### 5.1 Backend (Maven + wrapper)
1) Crear `backend/` como proyecto Maven con wrapper (`mvnw`/`.mvn/` dentro de `backend/`).
2) Definir:
- `groupId`: `com.sisferrete`
- `artifactId`: `backend`
- `package base`: `com.sisferrete`
3) Crear clase principal `SisferreteApplication` en `com.sisferrete`.
4) Agregar Actuator y configurar `management.endpoints.web.exposure.include=health,info` (o equivalente) en `application.yml`.
5) Agregar un controlador simple `GET /api/ping` que devuelva `{ "ok": true }` (para smoke básico).
6) Test mínimo que cargue contexto (SpringBootTest) para asegurar arranque.

### 5.2 Frontend (Vite + React + TS + Tailwind + shadcn)
1) Crear `frontend/` con Vite React TS.
2) Instalar Tailwind y configurar.
3) Instalar shadcn/ui (config inicial).
4) Crear:
- Página Login (texto ES): “Iniciar sesión”
- Placeholder app shell: menú lateral con items (POS, Productos, Inventario, Compras, Reportes) como placeholders.
5) No integrar auth real todavía.

### 5.3 Smoke script (PowerShell)
Crear `scripts/smoke/sprint2.ps1` que:
1) Inicie backend en background (o nueva ventana) y espere.
2) Haga request a `http://localhost:8080/actuator/health` y falle si no está UP.
3) Inicie frontend y verifique que el proceso arranca (si no se puede verificar con HTTP, al menos detecte “ready” en logs o deje instrucción clara).
4) Al final, muestre resumen y deje instrucciones para detener procesos.

> Si PowerShell background se complica, el script puede ser “paso a paso” (imprime comandos) pero debe ser ejecutable y útil.

### 5.4 Trazabilidad
- `docs/log/LOG.md`: agregar entrada nueva al final indicando ejecución SPR-002 y qué se creó.
- `docs/status/STATUS.md`: reflejar SPR-002 como `READY_FOR_VALIDATION` (nunca DONE).
- `docs/CHANGELOG.md`: en `[Unreleased]` agregar “Backend/Frontend scaffold base”.

---

## 6) Criterios de aceptación (AC)
- [ ] Existe `backend/` y ejecuta `./mvnw test` (desde `backend/`) sin fallar.
- [ ] `GET http://localhost:8080/actuator/health` responde UP cuando corre el backend.
- [ ] Existe `frontend/` y ejecuta `npm run dev` (desde `frontend/`) sin fallar.
- [ ] UI en español en pantallas placeholder.
- [ ] `scripts/smoke/sprint2.ps1` existe y ayuda a validar arranque.
- [ ] LOG actualizado (solo append).
- [ ] STATUS marca `READY_FOR_VALIDATION`.
- [ ] `git status` limpio al final.

---

## 7) Smoke test manual (usuario)
> Este sprint sí es validable localmente.

### Pasos
1) Backend:
   - `cd backend`
   - `./mvnw test`
   - `./mvnw spring-boot:run`
2) En otra terminal:
   - `curl http://localhost:8080/actuator/health`
   - `curl http://localhost:8080/api/ping`
3) Frontend:
   - `cd frontend`
   - `npm install`
   - `npm run dev`

### Evidencia a pegar
- Output de `./mvnw test`
- Respuesta de `/actuator/health` y `/api/ping`
- Output inicial de `npm run dev` (hasta ver que quedó “ready”)

---

## 8) “Comandos verdad”
Backend:
- `cd backend && ./mvnw test`
- `cd backend && ./mvnw spring-boot:run`

Frontend:
- `cd frontend && npm install`
- `cd frontend && npm run dev`

---

## 9) DoD (Definition of Done)
- AC completos.
- Repo compila.
- Estado: **READY_FOR_VALIDATION** (hasta que el usuario pegue outputs).

---

## 10) Si se detectan huecos/contradicciones
- NO editar este sprint.
- Crear RFC `docs/rfcs/RFC-00xx-<tema>.md`
- Si afecta arquitectura/contratos: ADR nuevo.
- Actualizar `docs/CHANGELOG.md`.

<!-- EOF -->
